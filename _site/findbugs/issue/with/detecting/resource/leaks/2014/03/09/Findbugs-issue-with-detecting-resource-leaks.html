<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800">
    <link rel='stylesheet' href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link href="/css/styles.css" rel="stylesheet" >
    <title>Findbugs issue with detecting resource leaks for resource initialized outside methods scope</title>
    <meta name="description" content="Recently while working with Findbugs plugin for Eclipse I discovered that Findbugs fails to identify resource leak in the scenarios where resource is initial...">
    <link rel="canonical" href="http://localhost:4000/findbugs/issue/with/detecting/resource/leaks/2014/03/09/Findbugs-issue-with-detecting-resource-leaks.html">
    <link rel="alternate" type="application/rss+xml" title="Sunil Sarolkar" href="/feed.xml">
  <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
  
</head>


  <body>

    <div class="container-fluid">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary dropdown">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="/">Index</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://docs.google.com/document/d/1lBajhi_YjRYu2kEF9YFi9jUbzvy_mJVcvY_TP5AAFLI/edit?usp=sharing">Profile</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
      </ul>
    </div>
  </nav>
</div>



    <div class="container text-xs-center text-md-left">
        <div class="row mt-4">
  <div class="col-sm-1"></div>
  <div class="col-sm-10">
    <h3>Findbugs issue with detecting resource leaks for resource initialized outside methods scope</h3>
    <p class="lead">Posted on 
      Mar 9, 2014 </p>
    <p><p>Recently while working with Findbugs plugin for Eclipse I discovered that Findbugs fails to identify resource leak in the scenarios where resource is initialized outside the method scope.</p>

<p>Below is the sample code in which Findbugs fails to detect resource leak</p>

<pre><code class="language-java">public class TestConn {
 // JDBC driver name and database URL
 static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";
 static final String DB_URL = "jdbc:mysql://localhost/EMP";

 // Database credentials
 static final String USER = "username";
 static final String PASS = "password";

 public static void main(String[] args) {
  Test();
 }// end main

 private static void Test() {
  Connection conn = null;
  Statement stmt = null;
  try {
   // STEP 2: Register JDBC driver
   Class.forName("com.mysql.jdbc.Driver");

   // STEP 3: Open a connection
   System.out.println("Connecting to database...");
   conn = getConn();//&lt;===Findbugs fails to detect connection leak

   // STEP 4: Execute a query
   System.out.println("Creating statement...");
   stmt = conn.createStatement();
   String sql;
   sql = "SELECT id, first, last, age FROM Employees";
   ResultSet rs = stmt.executeQuery(sql);

   // STEP 5: Extract data from result set
   while (rs.next()) {
    // Retrieve by column name
    int id = rs.getInt("id");
    int age = rs.getInt("age");
    String first = rs.getString("first");
    String last = rs.getString("last");

    // Display values
    System.out.print("ID: " + id);
    System.out.print(", Age: " + age);
    System.out.print(", First: " + first);
    System.out.println(", Last: " + last);
   }
   
  } catch (SQLException se) {
   // Handle errors for JDBC
   se.printStackTrace();
  } catch (Exception e) {
   // Handle errors for Class.forName
   e.printStackTrace();
  } finally {
   /*try {
    conn.close();
   } catch (SQLException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }*/
  }// end try
  System.out.println("Goodbye!");
 }

 private static Connection getConn() throws SQLException {
  return DriverManager.getConnection(DB_URL, USER, PASS);
 }
}
</code></pre>

<p>As you might already recognized the leak situation where connection object initialized at line 23.</p>

<pre><code class="language-java">conn = getConn();//&lt;===Findbugs fails to detect connection leak
</code></pre>

<p>The solution for the problem is not that straightforward and separate plugin was required to recognize the resource leak situations. This new plugin would act as add on for Findbugs to detect leak in this specific scenario.</p>

<p>You download the plugin at https://github.com/spsarolkar/Findbugs_AdResTrackr/blob/master/AdvancedResourceTrackr/dist/LeakedResourceDetector.jar</p>

<p>Feel free fork the repository “https://github.com/spsarolkar/Findbugs_AdResTrackr.git”</p>
</p>
    <p class="border-top border-primary">
    <h3 class="text-primary">Add Comment</h3>
      <form method="POST"  action="https://api.staticman.net/v2/entry/spsarolkar/spsarolkar.github.io/master/comments">

        <input name="options[redirect]" type="hidden" value="/findbugs/issue/with/detecting/resource/leaks/2014/03/09/Findbugs-issue-with-detecting-resource-leaks.html">
        <!-- e.g. "2016-01-02-this-is-a-post" -->
        <input name="options[slug]" type="hidden" value="Findbugs-issue-with-detecting-resource-leaks">
        <div class="form-group">
      <label for="inputEmail">Email address</label>
      <input type="email" name="fields[email]" class="form-control" id="inputEmail" aria-describedby="emailHelp" placeholder="Enter email" />
      <small id="emailHelp" class="form-text text-muted">I'll never share your email with anyone else.</small>
    </div>
    <div class="form-group">
      <label for="inputName">Name</label>
      <input type="text" name="fields[name]" class="form-control" id="inputName" aria-describedby="nameHelp" placeholder="Enter name" />
      <small id="nameHelp" class="form-text text-muted">Your Name as will be printed on the screen</small>
    </div>
    <div class="form-group">
      <label for="inputMessage">Message</label>
      <textarea id="inputMessage" class="form-control"  name="fields[message]" aria-label="Add comment message"></textarea>
    </div>
    <div class="form-group mt-4">
      <button type="button" class="btn btn-primary btn-lg ">Go !</button>
    </div>

      </form>
    </p>
  </div>
  <div class="col-sm-1"></div>
</div>

    </div>
      
    <!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

  </body>

</html>
